!function(s){"use strict";var r=function(e,t,r){var a=this;a.body=s("body"),a.container=e,a.settings=s.extend({dragging_threshold:200,helper:'<div class="gdlr-core-page-builder-helper" ></div>',placeholder:{main_class:"gdlr-core-page-builder-placeholder",wrapper:"gdlr-core-page-builder-placeholder-wrapper",column:"gdlr-core-page-builder-placeholder-column",item:"gdlr-core-page-builder-placeholder-item"},item_class:{wrapper:".gdlr-core-page-builder-wrapper",column:".gdlr-core-page-builder-column",item:".gdlr-core-page-builder-item"},container_class:{wrapper:".gdlr-container-sortable",column:".gdlr-container-sortable, .gdlr-core-wrapper-sortable",item:".gdlr-container-sortable, .gdlr-core-wrapper-sortable, .gdlr-core-column-sortable"},mousedown:function(e){return!0},startdragging:function(e){},dragging:function(e,t,r){},updateposition:function(e){},enddragging:function(e){}},t),a.template=s.extend({container:null,selector:".gdlr-core-pb-list-draggable",item_type:function(e){return"wrapper"},template_item:function(e){return e.clone()}},r),a.is_dragging=!1,a.current_item=null,a.current_item_type="",a.target=null,a.target_type="append",a.helper=null,a.placeholder=null,a.init()};r.prototype={init:function(){var e=this;for(var t in e.draggable_class="",e.settings.item_class)""!=e.draggable_class&&(e.draggable_class+=", "),e.draggable_class+=e.settings.item_class[t];e.bindContainer()},bindContainer:function(){var r,o=this,a=s(window).height(),l=0;s(window).resize(function(){a=s(window).height()}),null!=o.template.container&&o.template.container.on("mousedown",o.template.selector,function(e){null==o.current_item&&1==e.which&&o.settings.mousedown(e)&&(o.is_dragging=!0,o.current_item=s(this),o.current_item_type=o.template.item_type(o.current_item),o.body.addClass("gdlr-core-no-selection"),r=(new Date).getTime())}),o.container.on("mousedown",function(e){if(null==o.current_item&&1==e.which&&o.settings.mousedown(e)){o.is_dragging=!0,o.current_item=s(e.target).closest(o.draggable_class),o.current_item.addClass("gdlr-core-item-dragging"),o.current_item_type=o.check_item_type(o.current_item),o.body.addClass("gdlr-core-no-selection"),r=(new Date).getTime(),l=e.clientY;var t=setInterval(function(){o.is_dragging?0==r&&(l<.15*a?s("html, body").scrollTop(s(window).scrollTop()-10):.85*a<l&&s("html, body").scrollTop(s(window).scrollTop()+10)):clearInterval(t)},15)}}),s("body").on("mousemove",function(a){if(1==a.which&&(l=a.clientY,o.is_dragging))if(0==r){o.set_helper(a.pageX,a.pageY);var e=s(a.target).closest(o.settings.container_class[o.current_item_type]),t=e.children();0==(t=(t=t.not("."+o.settings.placeholder.main_class)).not(".gdlr-core-item-dragging")).length?0<e.length?(o.target=e,o.target_type="append"):o.target=null:t.each(function(){var e=s(this).offset(),t=s(this).outerWidth(),r=s(this).outerHeight();if(o.target=s(this),a.pageX>=e.left&&a.pageX<=e.left+t&&a.pageY>=e.top&&a.pageY<=e.top+r)return"column"==o.check_item_type(s(this))?a.pageX<=e.left+t/2?o.target_type="before":o.target_type="after":a.pageY<=e.top+r/2?o.target_type="before":o.target_type="after",!1;if("column"==o.check_item_type(s(this)))if(a.pageY>e.top+r)o.target_type="after";else{if(a.pageX<=e.left+t/2)return!(o.target_type="before");o.target_type="after"}else{if(a.pageY<=e.top+r/2)return!(o.target_type="before");o.target_type="after"}}),o.set_placeholder(),null!=o.placeholder&&null!=o.current_item&&o.settings.dragging(a,o.current_item,o.placeholder)}else r+o.settings.dragging_threshold<(new Date).getTime()&&(r=0,o.current_item.is(o.template.selector)||o.current_item.hide(),o.settings.startdragging(a))}),s("body").on("mouseup",function(e){1==e.which&&(null!=o.target&&null!=o.current_item&&(null==o.placeholder||o.placeholder.prev().is(o.current_item)||o.placeholder.next().is(o.current_item)||(o.current_item.is(o.template.selector)&&(o.current_item=o.template.template_item(o.current_item)),"append"==o.target_type?o.target.append(o.current_item):"before"==o.target_type?o.current_item.insertBefore(o.target):"after"==o.target_type&&o.current_item.insertAfter(o.target),o.settings.updateposition())),null!=o.target&&(o.target=null),null!=o.placeholder&&(o.placeholder.remove(),o.placeholder=null),null!=o.helper&&(o.helper.remove(),o.helper=null),o.is_dragging=!1,null!=o.current_item&&(o.current_item.removeClass("gdlr-core-item-dragging"),o.current_item.show(),0!=r||o.current_item.is(o.template.selector)||o.current_item.css({opacity:0,scale:.8}).transition({opacity:1,scale:1},200,function(){s(this).css({opacity:"",transform:""})}),o.current_item=null),o.body.removeClass("gdlr-core-no-selection"),o.settings.enddragging())})},set_placeholder:function(){var e=this;null!=e.target&&null!=e.current_item&&(null==e.placeholder&&(e.placeholder=s("<div ></div>").addClass(e.settings.placeholder.main_class),e.placeholder.addClass(e.settings.placeholder[e.current_item_type]),e.body.append(e.placeholder)),"append"==e.target_type?e.target.append(e.placeholder):"before"==e.target_type?e.placeholder.insertBefore(e.target):"after"==e.target_type&&e.placeholder.insertAfter(e.target))},set_helper:function(e,t){var r=this;null==r.helper&&(r.helper=s(r.settings.helper),r.body.append(r.helper)),r.helper.css({top:t,left:e})},check_item_type:function(e){for(var t in this.settings.item_class)if(e.is(this.settings.item_class[t]))return t;return""}};var e=function(){this.pb=s("#gdlr-core-page-builder"),this.pb_val=s("#gdlr-core-page-builder-val"),this.pb_nonce=s("#page_builder_security").val(),this.pb_tip=this.pb.siblings("#gdlr-core-page-builder-tip"),this.head_nav=this.pb.find("#gdlr-core-page-builder-head-nav"),this.head_content=this.pb.find("#gdlr-core-page-builder-head-content"),this.btn_full_screen=this.head_nav.find("#gdlr-core-page-builder-head-full-screen"),this.btn_reset=this.pb.find("#gdlr-core-page-builder-head-action-reset"),this.btn_save_template=this.pb.find("#gdlr-core-page-builder-head-action-save-template"),this.btn_view_mode=this.pb.find("#gdlr-core-page-builder-head-action-mode-section"),this.btn_live_mode=this.pb.find("#gdlr-core-page-builder-head-action-live-mode, #gdlr-core-page-builder-head-action-live-mode-alt"),this.content_stack=[],this.content_stack_active=-1,this.btn_undo=this.pb.find("#gdlr-core-page-builder-head-action-undo"),this.btn_redo=this.pb.find("#gdlr-core-page-builder-head-action-redo"),this.body_content=this.pb.children("#gdlr-core-page-builder-body"),this.body_container=this.body_content.children("#gdlr-core-page-builder-container"),this.init()};e.prototype={init:function(){var t=this;t.bind_fixed_nav(),t.bind_head_nav(),t.bind_head_action(),t.bind_full_screen(),t.bind_view_mode(),t.bind_wrapper_action(),t.bind_column_action(),t.bind_item_action(),t.body_content.find(".gdlr-core-page-builder-item-container-preview").find("a").attr("href","#gdlr-pb-link").off(),"undefined"!=typeof Strip&&Strip.disable(),t.bind_container_area(t.body_content),t.sortable_column_order(),s("#post-preview, #publish, #save-post").click(function(){console.log("save"),t.pb_update()}),s("#wpbody-content").on("click",".editor-post-publish-button, .editor-post-preview",function(){t.pb_update()}),"undefined"!=typeof YoastSEO&&"function"==typeof YoastSEO.app.registerPlugin&&(YoastSEO.app.registerPlugin("gdlrCorePB",{status:"ready"}),YoastSEO.app.registerModification("content",s.proxy(t.get_seo_content,t),"gdlrCorePB",5)),t.pb.on("gdlr-core-element-change",function(){t.pb.trigger("gdlr-core-element-resize"),"undefined"!=typeof YoastSEO&&"function"==typeof YoastSEO.app.pluginReloaded&&YoastSEO.app.pluginReloaded("gdlrCorePB")}),0<t.pb_tip.length&&t.pb.on("gdlr-core-show-tooltip",function(e){t.pb_tip.siblings(".gdlr-core-page-builder-tip");t.pb_tip.fadeIn(400),t.pb_tip.find(".gdlr-core-page-builder-tip-dismiss").click(function(){t.pb_tip.fadeOut(400,function(){s(this).remove()})}),t.pb.unbind("gdlr-core-show-tooltip",e.handleObj.handler,e),t.ajax_pb_update_option("gdlr-core-page-builder-tip",1)})},get_seo_content:function(e){return this.pb.find(".gdlr-core-page-builder-item-container-preview").each(function(){e+=s(this).children().not("script, style").html()}),e},pb_update:function(){var e=this,t=[];e.body_container.children("[data-template]").each(function(){t.push(e.pb_update_tempalte_val(s(this)))}),e.pb_val.val(JSON.stringify(t))},pb_update_tempalte_val:function(e){var t=this,r={};(r.template=e.attr("data-template"),r.type=e.attr("data-type"),e.attr("data-column")&&(r.column=e.attr("data-column")),e.data("value")&&(r.value=e.data("value")),"wrapper"==e.attr("data-template"))&&("background"==e.attr("data-type")?e.children(".gdlr-core-page-builder-wrapper-content").children(".gdlr-core-page-builder-wrapper-content-margin").children(".gdlr-core-page-builder-wrapper-content-wrap").children().children(".gdlr-core-page-builder-wrapper-container"):"sidebar"==e.attr("data-type")?e.children().children(".gdlr-core-page-builder-wrapper-sidebar-container").children(".gdlr-core-page-builder-wrapper-sidebar-content").children():e.children(".gdlr-core-page-builder-column-content").children(".gdlr-core-page-builder-column-content-margin").children(".gdlr-core-page-builder-column-content-wrap").children(".gdlr-core-page-builder-column-container")).children("[data-template]").each(function(){r.items||(r.items=[]),r.items.push(t.pb_update_tempalte_val(s(this)))});return r},update_undo_stack:function(e){e||(this.content_stack_active>=page_builder_var.settings.undo_times?this.content_stack.shift():(this.content_stack_active++,this.content_stack.splice(this.content_stack_active,page_builder_var.settings.undo_times))),this.content_stack[this.content_stack_active]=this.body_container.children().gdlr_core_clone()},update_undo_content:function(){this.body_container.html(this.content_stack[this.content_stack_active])},bind_view_mode:function(){var t=this;t.btn_view_mode.children(".gdlr-core-page-builder-head-action-mode").click(function(){var e=s(this).attr("data-mode");t.body_content.attr("data-mode")!=e&&(t.btn_view_mode.attr("data-mode",e),t.body_content.attr("data-mode",e),t.btn_live_mode.attr("data-mode",e),"live"==e?t.body_content.addClass("gdlr-core-pb-livemode").removeClass("gdlr-core-pb-blockmode"):t.body_content.addClass("gdlr-core-pb-blockmode").removeClass("gdlr-core-pb-livemode"),t.pb.trigger("gdlr-core-element-resize"),t.ajax_pb_update_option("gdlr-core-page-builder-view-mode",e))}),t.btn_live_mode.children().click(function(){if(!s(this).hasClass("gdlr-core-active")){var e=s(this).attr("data-live-mode");t.btn_live_mode.children('[data-live-mode="'+e+'"]').addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active"),"edit"==e?t.body_content.removeClass("gdlr-core-live-preview").addClass("gdlr-core-live-edit"):t.body_content.removeClass("gdlr-core-live-edit").addClass("gdlr-core-live-preview"),t.pb.trigger("gdlr-core-element-resize")}});var e=s(t.get_live_mode_container_css()).appendTo("body");s(window).resize(function(){e.remove(),e=s(t.get_live_mode_container_css()).appendTo("body")})},get_live_mode_container_css:function(){var e=(this.body_content.width()-this.body_container.width())/2;return'<style type="text/css">'+(".gdlr-core-pb-livemode .gdlr-core-page-builder-wrapper{margin-left:-"+e+"px; margin-right:-"+e+"px}")+"</style>"},bind_fixed_nav:function(){var t,r,a=this,o=a.pb.children(".gdlr-core-page-builder-head"),l=a.pb.children(".gdlr-core-page-builder-head-sub");s(window).scroll(function(){if(o.hasClass("gdlr-core-fixed"))if(s(window).scrollTop()+32<a.pb.offset().top+l.height()+0){var e=o.clone();e.insertAfter(o),e.slideUp(200,function(){s(this).remove()}),l.css("height",""),a.head_nav.children(".gdlr-core-page-builder-head-nav-item.gdlr-core-active").removeClass("gdlr-core-active"),a.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),t.addClass("gdlr-core-active"),r.addClass("gdlr-core-active").show(),o.removeClass("gdlr-core-fixed").css({width:"",display:"block"})}else s(window).scrollTop()+0>a.pb.offset().top+a.pb.outerHeight()?o.addClass("gdlr-core-outside").slideUp(200):o.hasClass("gdlr-core-outside")&&o.removeClass("gdlr-core-outside").slideDown(200);else s(window).scrollTop()+32>=a.pb.offset().top+o.outerHeight()+0&&s(window).scrollTop()+0<a.pb.offset().top+a.pb.outerHeight()&&(l.css("height",o.outerHeight()),t=a.head_nav.children(".gdlr-core-page-builder-head-nav-item.gdlr-core-active").removeClass("gdlr-core-active"),r=a.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),o.addClass("gdlr-core-fixed").css({display:"none",width:a.pb.outerWidth()}).slideDown(200))}),s(window).resize(function(){o.hasClass("gdlr-core-fixed")&&o.css({width:a.pb.outerWidth()})}),a.btn_full_screen.click(function(){o.hasClass("gdlr-core-fixed")&&o.hide()})},bind_head_nav:function(){var t=this;t.head_nav.children(".gdlr-core-page-builder-head-nav-item").click(function(){var e=s(this).attr("data-nav-type");s(this).hasClass("gdlr-core-active")?(s(this).removeClass("gdlr-core-active"),t.head_content.children('[data-content-type="'+e+'"]').removeClass("gdlr-core-active").css("display","block").slideUp(150)):(s(this).addClass("gdlr-core-active"),s(this).siblings(".gdlr-core-page-builder-head-nav-item").removeClass("gdlr-core-active"),t.head_content.children(".gdlr-core-active").length?(t.head_content.children(".gdlr-core-active").removeClass("gdlr-core-active").hide(),t.head_content.children('[data-content-type="'+e+'"]').addClass("gdlr-core-active").css({display:"none"}).fadeIn(150)):t.head_content.children('[data-content-type="'+e+'"]').addClass("gdlr-core-active").css({display:"none"}).slideDown(150))}),t.head_content.on("input",".gdlr-core-page-builder-head-content-search",gdlr_core_debounce(function(){var e=s(this).val();0<e.length?s(this).siblings().children(".gdlr-core-pb-list-draggable").each(function(){s(this).is('[data-title*="'+e+'"], [data-type*="'+e+'"]')?s(this).css({display:"block"}):s(this).css({display:"none"})}):s(this).siblings().children(".gdlr-core-pb-list-draggable").css({display:"block"})},300)),t.head_content.find(".gdlr-core-template-type-button").click(function(){if(!s(this).hasClass("gdlr-core-active")){s(this).addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active");var e=s(this).attr("data-type");s(this).parent().siblings(".gdlr-core-page-builder-head-content-template-container").each(function(){s(this).attr("data-type")==e?s(this).addClass("gdlr-core-active").css({display:"none"}).fadeIn(150):s(this).removeClass("gdlr-core-active").hide()})}}),t.bind_head_nav_click(),t.head_content.on("click",".gdlr-core-page-builder-head-content-custom-template-remove",function(){var e=s(this).closest(".gdlr-core-page-builder-head-content-custom-template-item");return gdlr_core_confirm_box({success:function(){t.ajax_get_template(null,{data:{security:t.pb_nonce,action:"gdlr_core_remove_pb_custom_template",slug:e.attr("data-template-slug")},success:function(e){"failed"==e.status&&(template.slideUp(200,function(){s(this).remove()}),gdlr_core_alert_box({status:e.status,head:e.head,message:e.message}))}}),e.fadeOut(200,function(){s(this).remove()})}}),!1})},bind_head_nav_click:function(){var r=this;r.head_content.on("click",".gdlr-core-pb-list-draggable",function(e){if(!s(e.target).is(".fa-remove")){var t=r.get_template(s(this));r.body_container.append(t),r.update_undo_stack(),t.css({opacity:0,scale:.8}).transition({opacity:1,scale:1},200,function(){s(this).css({opacity:"",transform:""})}),gdlr_core_alert_box({status:"success",head:page_builder_var.text.item_added,duration:1e3}),r.pb.trigger("gdlr-core-show-tooltip"),r.sortable_column_order()}})},bind_full_screen:function(){var r=this,e=s("#wpwrap"),t=(s("#wpadminbar"),r.pb.parent());r.btn_full_screen.click(function(){s(this).hasClass("gdlr-core-active")?(s(this).removeClass("gdlr-core-active"),e.css({display:""}),s("html").css({"padding-top":""}),t.append(r.pb),r.pb.removeClass("gdlr-core-fullscreen"),s(window).scrollTop(r.pb.offset().top).trigger("resize").trigger("scroll")):(s(this).addClass("gdlr-core-active"),e.css({display:"none"}),s("html").css({"padding-top":0}),s("body").append(r.pb.addClass("gdlr-core-fullscreen")),s("html, body").scrollTop(0).trigger("resize").trigger("scroll"))}),r.head_nav.find(".gdlr-core-page-builder-head-nav-update").click(function(){if(!s(this).hasClass("gdlr-core-now-loading")){var a=s(this).addClass("gdlr-core-now-loading"),e=s(this).attr("data-post-id"),t=[];r.body_container.children().each(function(){t.push(r.pb_update_tempalte_val(s(this)))}),s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:r.pb_nonce,action:"gdlr_core_save_page_builder_data",post_id:e,value:JSON.stringify(t)},dataType:"json",error:function(e,t,r){a.removeClass("gdlr-core-now-loading"),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){a.removeClass("gdlr-core-now-loading"),gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}})}})},get_template:function(e){var t=this,r="";if("wrapper"==e.attr("data-template")){if("column"==e.attr("data-type")){var a=e.attr("data-column");(r=s(page_builder_var.template.column)).addClass("gdlr-core-column-"+a).attr("data-column",a),r.find(".gdlr-core-page-builder-column-head-title").html(page_builder_var.column[a])}else r=s(page_builder_var.template[e.attr("data-type")]);t.update_element_preview(r)}else"element"==e.attr("data-template")?((r=s(page_builder_var.template.element)).attr("data-type",e.attr("data-type")),r.find(".gdlr-core-page-builder-item-container-item-title, .gdlr-core-page-builder-item-head-item-title").html(e.attr("data-title")),t.update_element_preview(r)):"template"==e.attr("data-template")?((r=s(page_builder_var.template.template)).attr("data-type",e.attr("data-type")),r.attr("data-template-slug",e.attr("data-template-slug")),t.ajax_get_template(r,{data:{security:t.pb_nonce,action:"gdlr_core_get_pb_template",slug:e.attr("data-template-slug")}})):"custom-template"==e.attr("data-template")&&((r=s(page_builder_var.template.template)).attr("data-type",e.attr("data-type")),r.attr("data-template-slug",e.attr("data-template-slug")),t.ajax_get_template(r,{data:{security:t.pb_nonce,action:"gdlr_core_get_pb_custom_template",slug:e.attr("data-template-slug")}}));return r},bind_wrapper_action:function(){var r=this;r.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-remove",function(){s(this).closest(".gdlr-core-page-builder-wrapper").fadeOut(200,function(){s(this).remove(),r.pb.trigger("gdlr-core-element-change"),r.update_undo_stack()})}),r.body_content.on("dblclick",".gdlr-core-page-builder-wrapper",function(){var e=s(this);return r.ajax_get_options({data:{security:r.pb_nonce,action:"gdlr_core_get_pb_options",template:e.attr("data-template"),type:e.attr("data-type"),value:e.data("value")}},e),!1}),r.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-edit",function(){var e=s(this).closest(".gdlr-core-page-builder-wrapper");r.ajax_get_options({data:{security:r.pb_nonce,action:"gdlr_core_get_pb_options",template:e.attr("data-template"),type:e.attr("data-type"),value:e.data("value")}},e)}),r.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-save",function(){var e=[];e.push(r.pb_update_tempalte_val(s(this).closest(".gdlr-core-page-builder-wrapper"))),r.lb_save_custom_template(e,"wrapper")}),r.body_content.on("click",".gdlr-core-page-builder-wrapper .gdlr-core-page-builder-wrapper-copy",function(){var e=s(this).closest(".gdlr-core-page-builder-wrapper"),t=e.gdlr_core_clone();t.insertAfter(e),t.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){s(this).css({opacity:"",transform:""})}),r.update_undo_stack()})},bind_column_action:function(){var i=this;i.body_container.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-size i",function(){var e=s(this).closest(".gdlr-core-page-builder-column"),t=e.attr("data-column"),r=s(this).closest(".gdlr-core-page-builder-column-head").find(".gdlr-core-page-builder-column-head-title"),a=10,o=60;for(var l in page_builder_var.column)if(l<t)a=l;else if(t<l){o=l;break}s(this).hasClass("gdlr-core-page-builder-column-increase")?(t!=o&&(e.removeClass("gdlr-core-column-"+t),r.html(page_builder_var.column[o]),e.addClass("gdlr-core-column-"+o).attr("data-column",o)),i.sortable_column_order(),i.pb.trigger("gdlr-core-element-resize"),i.update_undo_stack()):s(this).hasClass("gdlr-core-page-builder-column-decrease")&&(t!=a&&(e.removeClass("gdlr-core-column-"+t),r.html(page_builder_var.column[a]),e.addClass("gdlr-core-column-"+a).attr("data-column",a)),i.sortable_column_order(),i.pb.trigger("gdlr-core-element-resize"),i.update_undo_stack())}),i.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-remove",function(){s(this).closest(".gdlr-core-page-builder-column").fadeOut(200,function(){s(this).remove(),i.sortable_column_order(),i.pb.trigger("gdlr-core-element-change"),i.update_undo_stack()})}),i.body_content.on("dblclick",".gdlr-core-page-builder-column",function(e){if(s(e.target).is(".gdlr-core-page-builder-column-increase, .gdlr-core-page-builder-column-decrease"))return!1;var t=s(this);return i.ajax_get_options({data:{security:i.pb_nonce,action:"gdlr_core_get_pb_options",template:t.attr("data-template"),type:t.attr("data-type"),value:t.data("value")}},t),!1}),i.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-edit",function(){var e=s(this).closest(".gdlr-core-page-builder-column");i.ajax_get_options({data:{security:i.pb_nonce,action:"gdlr_core_get_pb_options",template:e.attr("data-template"),type:e.attr("data-type"),value:e.data("value")}},e)}),i.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-save",function(){var e=[];e.push(i.pb_update_tempalte_val(s(this).closest(".gdlr-core-page-builder-column"))),i.lb_save_custom_template(e,"column")}),i.body_content.on("click",".gdlr-core-page-builder-column .gdlr-core-page-builder-column-copy",function(){var e=s(this).closest(".gdlr-core-page-builder-column"),t=e.gdlr_core_clone();t.insertAfter(e),t.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){s(this).css({opacity:"",transform:""})}),i.sortable_column_order(),i.update_undo_stack()})},bind_item_action:function(){var r=this;r.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-remove",function(){s(this).closest(".gdlr-core-page-builder-item").fadeOut(200,function(){s(this).remove(),r.pb.trigger("gdlr-core-element-change"),r.update_undo_stack()})}),r.body_content.on("dblclick",".gdlr-core-page-builder-item",function(){var e=s(this);return r.ajax_get_options({data:{security:r.pb_nonce,action:"gdlr_core_get_pb_options",template:e.attr("data-template"),type:e.attr("data-type"),value:e.data("value")}},e),!1}),r.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-edit",function(){var e=s(this).closest(".gdlr-core-page-builder-item");r.ajax_get_options({data:{security:r.pb_nonce,action:"gdlr_core_get_pb_options",template:e.attr("data-template"),type:e.attr("data-type"),value:e.data("value")}},e)}),r.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-save",function(){var e=[];e.push(r.pb_update_tempalte_val(s(this).closest(".gdlr-core-page-builder-item"))),r.lb_save_custom_template(e,"element")}),r.body_content.on("click",".gdlr-core-page-builder-item .gdlr-core-page-builder-item-copy",function(){var e=s(this).closest(".gdlr-core-page-builder-item"),t=e.gdlr_core_clone();t.insertAfter(e),t.css({opacity:0,scale:0}).transition({opacity:1,scale:1},150,function(){s(this).css({opacity:"",transform:""})}),r.update_undo_stack()})},bind_head_action:function(){var t=this;t.update_undo_stack(),t.btn_undo.click(function(){0<t.content_stack_active?(t.content_stack_active--,t.update_undo_content()):gdlr_core_alert_box({status:"success",head:page_builder_var.text.undo_end})}),t.btn_redo.click(function(){void 0!==t.content_stack[t.content_stack_active+1]?(t.content_stack_active++,t.update_undo_content()):gdlr_core_alert_box({status:"success",head:page_builder_var.text.redo_end})}),t.btn_reset.click(function(){gdlr_core_confirm_box({success:function(){t.body_container.empty(),t.update_undo_stack()},sub:""})}),t.btn_save_template.click(function(){var e=[];t.body_container.children().each(function(){e.push(t.pb_update_tempalte_val(s(this)))}),console.log(window.gdlr_core_array_count(e)),t.lb_save_custom_template(e,"wrapper")}),t.btn_save_template.contextmenu(function(){var e=[];t.body_container.children().each(function(){e.push(t.pb_update_tempalte_val(s(this)))}),console.log(JSON.stringify(e))})},ajax_pb_update_option:function(e,t){void 0!==e&&void 0!==t&&s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:this.pb_nonce,action:"gdlr_core_pb_update_option",slug:e,value:t},dataType:"json",error:function(e,t,r){console.log(e,t,r)},success:function(e){void 0!==e&&e&&console.log(e)}})},ajax_get_options:function(e,t){var a=this,o=s('<div class="gdlr-core-page-builder-loading" ></div>'),r=s.extend({beforeSend:function(e,t){var r=a.pb.offset().left+a.pb.outerWidth()/2;o.css({display:"none",left:r}).appendTo("body"),o.fadeIn(150)},error:function(e,t,r){o.remove(),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){o.remove(),"success"==e.status?a.lb_options(e.option_content,t):"failed"==e.status&&gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}},e);s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:r.data,dataType:"json",beforeSend:r.beforeSend,error:r.error,success:r.success})},ajax_get_skin_options:function(t){var r=this,a=s('<div class="gdlr-core-page-builder-loading" ></div>');s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:r.pb_nonce,action:"gdlr_core_get_skin_options"},dataType:"json",beforeSend:function(e,t){a.css({display:"none"}).appendTo("body"),a.fadeIn(150)},error:function(e,t,r){a.remove(),gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){a.remove(),"success"==e.status?r.lb_skin_options(e.option_content,t):"failed"==e.status&&gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}})},ajax_update_skin:function(e,r){s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:this.pb_nonce,action:"gdlr_core_update_skin",value:e,skin:r.val()},dataType:"json",error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){if(console.log(e),"success"==e.status){if(console.log(e),void 0!==e.combobox&&r.html(e.combobox),void 0!==e.style){var t=s("#gdlr-core-skin-style-temp");t.length||(t=s('<style type="text/css" id="gdlr-core-skin-style-temp" ></style>'),s("body").append(t)),t.html(e.style)}}else"failed"==e.status&&gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}})},ajax_get_template:function(r,e){var a=this,t=s.extend({error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){if("success"==e.status){var t=s(e.content);r.replaceWith(t),a.pb.trigger("gdlr-core-element-change"),a.update_undo_stack(!0)}else"failed"==e.status&&(r.slideUp(200,function(){s(this).remove()}),gdlr_core_alert_box({status:e.status,head:e.head,message:e.message}))}},e);s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:t.data,dataType:"json",beforeSend:t.beforeSend,error:t.error,success:t.success})},ajax_save_template:function(e,t){var r=s.extend({error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){"success"==e.status&&gdlr_core_alert_box({status:e.status,head:e.head,message:e.message}),gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}},t);s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:r.data,dataType:"json",beforeSend:r.beforeSend,error:r.error,success:r.success})},update_element_preview:function(e){var a=this;e.find(".gdlr-core-page-builder-item-container-preview").each(function(){var e=s(this).closest(".gdlr-core-page-builder-item"),r=s(this).addClass("gdlr-core-now-loading");s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:a.pb_nonce,action:"gdlr_core_get_pb_element_preview",type:e.attr("data-type"),value:e.data("value"),post_id:page_builder_var.post_id},dataType:"json",error:function(e,t,r){console.log(e,t,r)},success:function(e){if(r.removeClass("gdlr-core-now-loading"),"success"==e.status&&e.preview_content){var t=s(e.preview_content);t.find("a").attr("href","#gdlr-pb-link").removeClass("gdlr-core-ilightbox"),r.html(t),a.pb.trigger("gdlr-core-element-change"),a.update_undo_stack(!0)}}})})},update_wrapper_preview:function(r){var e=this.pb_update_tempalte_val(r);r.addClass("gdlr-core-now-loading"),s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:this.pb_nonce,action:"gdlr_core_get_pb_wrapper_preview",type:r.attr("data-type"),value:e},dataType:"json",error:function(e,t,r){console.log(e,t,r)},success:function(e){if(r.removeClass("gdlr-core-now-loading"),"success"==e.status&&e.preview_content){var t=s(e.preview_content);r.replaceWith(t)}}})},lb_save_custom_template:function(t,r){var a=this,o=s(page_builder_var.template.custom_template_lb);s("body").append(o),o.css({opacity:0}).animate({opacity:1},200),o.find(".gdlr-core-custom-template-lb-head-close").click(function(){o.animate({opacity:0},200,function(){s(this).remove()})}),o.find(".gdlr-core-custom-template-save").click(function(){var e=s(this).siblings(".gdlr-core-custom-template-name").val();""==e?gdlr_core_alert_box({status:"failed",head:page_builder_var.template.custom_template_no_text_head,message:page_builder_var.template.custom_template_no_text_message}):(o.animate({opacity:0},200,function(){s(this).remove()}),s.ajax({type:"POST",url:page_builder_var.text.ajaxurl,data:{security:a.pb_nonce,action:"gdlr_core_save_pb_custom_template",value:t,type:r,title:e},dataType:"json",error:function(e,t,r){gdlr_core_alert_box({status:"failed",head:page_builder_var.text.error_head,message:page_builder_var.text.error_message}),console.log(e,t,r)},success:function(e){if("success"==e.status){var t=s(e.nav_item);a.head_content.children('[data-content-type="custom-template"]').find(".gdlr-core-page-builder-head-content-custom-template-container").append(t)}gdlr_core_alert_box({status:e.status,head:e.head,message:e.message})}}))})},lb_options:function(e,t){var r=this,a=s('<div class="gdlr-core-lightbox-content-wrapper"></div>'),o=s('<div class="gdlr-core-lightbox-content"></div>');a.append(o),o.append(e),s("body").append(a).css({overflow:"hidden",width:s("body").width()}),a.css({opacity:0}).animate({opacity:1},400);var l=new gdlrCoreHtmlOption(o);o.find(".gdlr-core-html-option-skin-edit").click(function(){var e=s(this).siblings(".gdlr-core-html-option-item-input").find("select");r.ajax_get_skin_options(e)});var i=o.find("#gdlr-core-page-builder-options-tab-head"),n=o.find("#gdlr-core-page-builder-options-tab-content");i.children(".gdlr-core-page-builder-options-tab-head-item").click(function(){if(!s(this).hasClass("gdlr-core-active")){var e=s(this).attr("data-tab-slug");s(this).addClass("gdlr-core-active").siblings().removeClass("gdlr-core-active"),n.find('[data-tab-slug="'+e+'"]').fadeIn(200).siblings().css("display","none")}}),o.find("#gdlr-core-page-builder-options-head-close").click(function(){a.fadeOut(200,function(){s(this).remove(),s("body").css({overflow:"",width:""})})});var d=o.find("#gdlr-core-page-builder-options-save");d.click(function(){var e=l.get_val();t.data("value",e),a.fadeOut(200,function(){s(this).remove(),s("body").css({overflow:"",width:""})}),r.update_undo_stack(),t.is(".gdlr-core-page-builder-item")?r.update_element_preview(t):t.is(".gdlr-core-page-builder-wrapper, .gdlr-core-page-builder-column")&&r.update_wrapper_preview(t)});var c=!1;o.children().click(function(){c=!0}),a.click(function(){c||d.trigger("click"),c=!1})},lb_skin_options:function(e,t){var r=this,a=s('<div class="gdlr-core-lightbox-content-wrapper gdlr-core-lightbox-skin-content-wrapper"></div>'),o=s('<div class="gdlr-core-lightbox-content"></div>');a.append(o),o.append(e),s("body").append(a),a.css({opacity:0}).animate({opacity:1},400);var l=new gdlrCoreHtmlOption(o);o.find("#gdlr-core-page-builder-options-head-close").click(function(){a.fadeOut(200,function(){s(this).remove()})});var i=o.find("#gdlr-core-page-builder-options-save");i.click(function(){var e=l.get_val();r.ajax_update_skin(e,t),a.fadeOut(200,function(){s(this).remove()})});var n=!1;o.children().click(function(){n=!0}),a.click(function(){n||i.trigger("click"),n=!1})},bind_container_area:function(e){var t=this;new r(e,{mousedown:function(e){return!t.body_content.is(".gdlr-core-pb-livemode.gdlr-core-live-preview")},startdragging:function(e){t.sortable_column_order(),t.pb.addClass("gdlr-core-dragging"),t.body_content.removeClass("gdlr-core-no-dragging")},dragging:function(e,t,r){r.removeClass("gdlr-core-placeholder-clear");for(var a=r.prev();0<a.length&&"none"==a.css("display");)a=a.prev();0<a.length&&(a.hasClass("gdlr-core-last-row")||a.hasClass("gdlr-core-last-item")&&!t.is('.gdlr-core-page-builder-column, [data-type="column"]'))&&r.addClass("gdlr-core-placeholder-clear")},updateposition:function(e){t.update_undo_stack()},enddragging:function(e){t.sortable_column_order(),t.update_undo_stack(!0),t.pb.removeClass("gdlr-core-dragging"),t.body_content.addClass("gdlr-core-no-dragging"),t.pb.trigger("gdlr-core-element-resize"),t.pb.trigger("gdlr-core-show-tooltip")}},{container:t.head_content,item_type:function(e){return"wrapper"==e.attr("data-template")?"column"==e.attr("data-type")?"column":"wrapper":"element"==e.attr("data-template")?"item":"wrapper"},template_item:function(e){return t.get_template(e)}})},sortable_column_order:function(){var r=0;this.body_content.find(".gdlr-core-page-builder-column").removeClass("gdlr-core-last-row gdlr-core-last-item gdlr-core-first").each(function(){if("none"!=s(this).css("display")){for(var e=s(this).prev();"none"==e.css("display")||e.hasClass("gdlr-core-page-builder-placeholder");)e=e.prev();0!=r&&e.is(".gdlr-core-page-builder-column")||(s(this).addClass("gdlr-core-first"),r=0),(r+=parseInt(s(this).attr("data-column")))%60==0?(s(this).addClass("gdlr-core-last-row"),r=0):60<r&&(s(this).addClass("gdlr-core-first"),r=parseInt(s(this).attr("data-column")));for(var t=s(this).next();0<t.length&&("none"==t.css("display")||t.hasClass("gdlr-core-page-builder-placeholder"));)t=t.next();0!=t.length&&t.is(".gdlr-core-page-builder-column")||s(this).addClass("gdlr-core-last-item")}})}},s(document).ready(function(){new e})}(jQuery);